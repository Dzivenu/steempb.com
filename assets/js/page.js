/*!
 * STEEM PB v1.0
 *
 * Copyright 2013 WarrantyNowVoid.com
 * Licensed under the Apache License v2.0
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Designed and built half-drunk and mostly insane by @pettazz.
 *
 * Load javascript stuff required to build the page
 */

// Modernizr.load({
//     test: Modernizr.csstransforms3d,
//     yep : '/assets/css/experimental.css'
// }); 

//determine if this is @2x territory
var isRetina = Math.floor(window.devicePixelRatio) > 1;
console.log('@2x support: ' + isRetina);

var lastScrollTop = 0;

$(document).ready(function(){
    // Konami loader
    var eggloader = new Konami(function(){
        if(typeof easterEgg == "undefined"){
            // wow such default pretty
            suchDogeWow();
        }else if(typeof easterEgg == "function"){
            easterEgg();
        }else if(typeof easterEgg == "string"){
            switch(easterEgg){
                default:
                    suchDogeWow();
                    break;
            }
        }else{
            console.log("Poopguy doesn't know what the fuck to do with this easter egg. You get doge instead.");
            suchDogeWow();
        }
    }); 

    //make jetguy fly
    $(document).scroll(function(eData){
        var currentOffset = $('#jetguy-main').offset();
        var currentScrollTop = $(this).scrollTop();
        if(currentScrollTop > lastScrollTop){
            $('#jetguy-main').offset({
                top: currentOffset.top - 9,
                left: currentOffset.left + 3
            });
        }else{
            $('#jetguy-main').offset({
                top: currentOffset.top + 9,
                left: currentOffset.left - 3
            });
        }

    });
});

function suchDogeWow(){
    if(typeof LIBDOGE == "undefined"){
        yepnope.injectJs('/assets/js/libdoge.min.js', function(){
            LIBDOGE.controller.buyDoge();
        });
    }else{
        LIBDOGE.controller.buyDoge();
    }
}

$(function() {
  $('a[href*=#]:not([href=#])').click(function() {
    if (location.pathname.replace(/^\//,'') == this.pathname.replace(/^\//,'') && location.hostname == this.hostname) {
      var target = $(this.hash);
      target = target.length ? target : $('[name=' + this.hash.slice(1) +']');
      if (target.length) {
        $('html,body').animate({
          scrollTop: target.offset().top
        }, 1000);
        return false;
      }
    }
  });
});